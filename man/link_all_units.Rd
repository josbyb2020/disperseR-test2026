% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/link_all_units.R
\name{link_all_units}
\alias{link_all_units}
\title{Link air parcels to spatial units for multiple emission sources}
\usage{
link_all_units(
  units.run,
  link.to = "zips",
  mc.cores = parallel::detectCores(),
  year.mons = NULL,
  start.date = NULL,
  end.date = NULL,
  pbl_trim = TRUE,
  pbl.height = NULL,
  crosswalk. = NULL,
  counties. = NULL,
  hysp_dir = NULL,
  ziplink_dir = NULL,
  duration.run.hours = 240,
  res.link = 12000,
  overwrite = FALSE,
  pbl.trim = NULL,
  crop.usa = FALSE,
  return.linked.data = TRUE
)
}
\arguments{
\item{units.run}{A data.table with columns: ID (character), uID (character),
Latitude (numeric), Longitude (numeric), year (integer)}

\item{link.to}{One of 'zips', 'counties', or 'grids'}

\item{mc.cores}{Number of cores for parallel computation. Set to 1 for serial.}

\item{year.mons}{Months for linking (use get_yearmon() to create)}

\item{start.date}{Optional start date (alternative to year.mons)}

\item{end.date}{Optional end date (alternative to year.mons)}

\item{pbl_trim}{Trim parcels under monthly PBL heights? Default TRUE}

\item{pbl.height}{Monthly boundary layer heights (required if pbl_trim=TRUE)}

\item{crosswalk.}{Crosswalk data (required if link.to='zips')}

\item{counties.}{County sf object (required if link.to='counties')}

\item{duration.run.hours}{Duration in hours (default 240 = 10 days)}

\item{res.link}{Grid resolution in meters (default 12000)}

\item{overwrite}{Overwrite existing files? Default FALSE}

\item{pbl.trim}{Legacy parameter, use pbl_trim instead}

\item{crop.usa}{Crop output to lower 48 states? (grids only)}

\item{return.linked.data}{Return linked data? Default TRUE}
}
\value{
data.table with linked spatial data
}
\description{
Links all air parcels to relevant spatial scales (ZIP codes,
counties, or grids) by month for specified units. Reads HYSPLIT output files
produced by run_disperser_parallel() and performs spatial aggregation.

Automatically uses appropriate parallelization based on OS:
mclapply on Unix/macOS, parLapply on Windows.
}
